// PerlinSimplex 1.2
// Ported from Stefan Gustavson's java implementation by Sean McCullough banksean@gmail.com
if(!this.PerlinSimplex){var PerlinSimplex=function(){var T=0.5*(Math.sqrt(3)-1),F=(3-Math.sqrt(3))/6,V=2*F-1,R=1/3,D=1/6,P=(Math.sqrt(5)-1)/4,B=(5-Math.sqrt(5))/20,p=B*2,o=B*3,n=B*4-1,A=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],a=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],au,aG=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]],al,aJ,aI,aH,aF,aE,Y,ap,aC,ai,ah,ag,ae,W,N,x,aV,af,az,at,U,G,ay,ar,S,E,ax,aq,Q,C,M,w,aU,ad,K,v,aT,ac,J,u,aR,ab,I,r,aQ,aa,Z,H,q,aM,ao,an,am,ak,aj,aP,aO,aN,aL,aK,aS=Math,O=1,X=0.5,aA,f,av,m,aw,aB,z=function(){var c,g;m=[];aw=[];aB=0;for(var j=0;j<O;j++){c=Math.pow(2,j);g=Math.pow(X,j);aB+=g;m.push(c);aw.push(g)}aB=1/aB},h=function(i,c){return i[0]*c},e=function(i,c,j){return i[0]*c+i[1]*j},d=function(i,c,k,j){return i[0]*c+i[1]*k+i[2]*j},b=function(j,c,l,k,i){return j[0]*c+j[1]*l+j[2]*k+j[3]*i},L=function(){var c,g=[];for(c=0;c<256;c++){g[c]=Math.floor(aS.random()*256)}au=[];for(c=0;c<512;c++){au[c]=g[c&255]}},y=function(c,g){Y=(c+g)*T;ai=Math.floor(c+Y);ah=Math.floor(g+Y);W=(ai+ah)*F;N=c-(ai-W);x=g-(ah-W);if(N>x){az=1;at=0}else{az=0;at=1}M=N-az+F;w=x-at+F;K=N+V;v=x+V;Z=ai&255;H=ah&255;aP=0.5-N*N-x*x;if(aP<0){aJ=0}else{aP*=aP;ao=au[Z+au[H]]%12;aJ=aP*aP*e(A[ao],N,x)}aO=0.5-M*M-w*w;if(aO<0){aI=0}else{aO*=aO;an=au[Z+az+au[H+at]]%12;aI=aO*aO*e(A[an],M,w)}aN=0.5-K*K-v*v;if(aN<0){aH=0}else{aN*=aN;am=au[Z+1+au[H+1]]%12;aH=aN*aN*e(A[am],K,v)}return 70*(aJ+aI+aH)},aW=function(c,i,g){Y=(c+i+g)*R;ai=Math.floor(c+Y);ah=Math.floor(i+Y);ag=Math.floor(g+Y);W=(ai+ah+ag)*D;N=c-(ai-W);x=i-(ah-W);aV=g-(ag-W);if(N>=x){if(x>=aV){az=1;at=0;U=0;ay=1;ar=1;S=0}else{if(N>=aV){az=1;at=0;U=0;ay=1;ar=0;S=1}else{az=0;at=0;U=1;ay=1;ar=0;S=1}}}else{if(x<aV){az=0;at=0;U=1;ay=0;ar=1;S=1}else{if(N<aV){az=0;at=1;U=0;ay=0;ar=1;S=1}else{az=0;at=1;U=0;ay=1;ar=1;S=0}}}M=N-az+D;w=x-at+D;aU=aV-U+D;K=N-ay+R;v=x-ar+R;aT=aV-S+R;J=N-0.5;u=x-0.5;aR=aV-0.5;Z=ai&255;H=ah&255;q=ag&255;aP=0.6-N*N-x*x-aV*aV;if(aP<0){aJ=0}else{aP*=aP;ao=au[Z+au[H+au[q]]]%12;aJ=aP*aP*d(A[ao],N,x,aV)}aO=0.6-M*M-w*w-aU*aU;if(aO<0){aI=0}else{aO*=aO;an=au[Z+az+au[H+at+au[q+U]]]%12;aI=aO*aO*d(A[an],M,w,aU)}aN=0.6-K*K-v*v-aT*aT;if(aN<0){aH=0}else{aN*=aN;am=au[Z+ay+au[H+ar+au[q+S]]]%12;aH=aN*aN*d(A[am],K,v,aT)}aL=0.6-J*J-u*u-aR*aR;if(aL<0){aF=0}else{aL*=aL;ak=au[Z+1+au[H+1+au[q+1]]]%12;aF=aL*aL*d(A[ak],J,u,aR)}return 32*(aJ+aI+aH+aF)},aD=function(c,j,i,g){Y=(c+j+i+g)*P;ai=Math.floor(c+Y);ah=Math.floor(j+Y);ag=Math.floor(i+Y);ae=Math.floor(g+Y);W=(ai+ah+ag+ae)*B;N=c-(ai-W);x=j-(ah-W);aV=i-(ag-W);af=g-(ae-W);ap=0;if(N>x){ap=32}if(N>aV){ap|=16}if(x>aV){ap|=8}if(N>af){ap|=4}if(x>af){ap|=2}if(aV>af){ap|=1}aC=aG[ap];az=aC[0]>=3?1:0;at=aC[1]>=3?1:0;U=aC[2]>=3?1:0;G=aC[3]>=3?1:0;ay=aC[0]>=2?1:0;ar=aC[1]>=2?1:0;S=aC[2]>=2?1:0;E=aC[3]>=2?1:0;ax=aC[0]>=1?1:0;aq=aC[1]>=1?1:0;Q=aC[2]>=1?1:0;C=aC[3]>=1?1:0;M=N-az+B;w=x-at+B;aU=aV-U+B;ad=af-G+B;K=N-ay+p;v=x-ar+p;aT=aV-S+p;ac=af-E+p;J=N-ax+o;u=x-aq+o;aR=aV-Q+o;ab=af-C+o;I=N+n;r=x+n;aQ=aV+n;aa=af+n;Z=ai&255;H=ah&255;q=ag&255;aM=ae&255;aP=0.6-N*N-x*x-aV*aV-af*af;if(aP<0){aJ=0}else{aP*=aP;ao=au[Z+au[H+au[q+au[aM]]]]%32;aJ=aP*aP*b(a[ao],N,x,aV,af)}aO=0.6-M*M-w*w-aU*aU-ad*ad;if(aO<0){aI=0}else{aO*=aO;an=au[Z+az+au[H+at+au[q+U+au[aM+G]]]]%32;aI=aO*aO*b(a[an],M,w,aU,ad)}aN=0.6-K*K-v*v-aT*aT-ac*ac;if(aN<0){aH=0}else{aN*=aN;am=au[Z+ay+au[H+ar+au[q+S+au[aM+E]]]]%32;aH=aN*aN*b(a[am],K,v,aT,ac)}aL=0.6-J*J-u*u-aR*aR-ab*ab;if(aL<0){aF=0}else{aL*=aL;ak=au[Z+ax+au[H+aq+au[q+Q+au[aM+C]]]]%32;aF=aL*aL*b(a[ak],J,u,aR,ab)}aK=0.6-I*I-r*r-aQ*aQ-aa*aa;if(aK<0){aE=0}else{aK*=aK;aj=au[Z+1+au[H+1+au[q+1+au[aM+1]]]]%32;aE=aK*aK*b(a[aj],I,r,aQ,aa)}return 27*(aJ+aI+aH+aF+aE)};L();return{noise:function(c,j,i,g){aA=0;for(al=0;al<O;al++){f=m[al];av=aw[al];switch(arguments.length){case 4:aA+=av*aD(f*c,f*j,f*i,f*g);break;case 3:aA+=av*aW(f*c,f*j,f*i);break;default:aA+=av*y(f*c,f*j)}}return(aA*aB+1)*0.5},noiseDetail:function(c,g){O=c||O;X=g||X;z()},setRng:function(c){aS=c;L()},toString:function(){return"[object PerlinSimplex "+O+" "+X+"]"}}}()};